## 7-1 다양한 보조 기억 장치

보조 기억 장치에는 다양한 종류가 있습니다.

그 중 가장 대중적인 보조 기억 장치는 하드 디스크와 플래시 메모리입니다.

<aside>

> 플래시 메모리란? <br>
> 흔히 사용하는 USB 메모리, SD 카드, SSD와 같은 저장 장치를 말합니다.

</aside>

### 하드 디스크

하드 디스크는 자기적인 방식으로 데이터를 저장하는 보조 기억 장치입니다.

이 때문에 하드 디스크를 자기 디스크의 일종으로 지칭하기도 합니다.

하드 디스크는 CD나 LP와 비슷하게 동작합니다.

동그란 원판에 데이터를 저장하고, 그것을 뾰족한 리더기로 데이터를 읽습니다.

### 하드 디스크의 구성 요소

- 플래터
    - 하드 디스크에서 실질적으로 데이터가 저장되는 동그란 원판
    - 자기 물질로 덮여 있어 수많은 N극과 S극을 저장한다.
    - N극과 S극은 0과 1의 역할을 수행

- 스핀들
    - 플래터를 회전시키는 구성 요소
    - 스핀들이 플래터를 돌리는 속도는 분당 회전수로 나타내는 RPM으로 표현한다.

- 헤드
    - 플래터 위에서 미세하기 떠 있는 채로 데이터를 읽고 쓰는, 마치 바늘같이 생긴 부품
    - 디스크 암에 부착되어 있다.
        - 디스크 암 : 원하는 위치로 헤드를 이동시키는 부품

CD나 LP에 비해 하드 디스크는 훨씬 더 많은 양의 데이터를 저장해야 하므로,

일반적으로 여러 겹의 플래터로 이루어져 있고 플래터 양면을 모두 사용할 수 있습니다.

양면 플래터를 사용하면 위아래로 플래터당 두 개의 헤드가 사용됩니다.

일반적으로 모든 헤드는 디스크 암에 부착되어 다 같이 이동합니다.

### 플래터에 데이터가 어떻게 저장될까?

플래터는 **트랙**과 **섹터**라는 단위로 데이터를 저장합니다.

- 트랙이란?
    - 플래터를 여러 동심원으로 나누었을 때,  그 중 하나의 원을 트랙이라고 칭합니다.
- 섹터란?
    - 트랙은 여러 조각으로 나누어지는데, 이 한 조각을 섹터라고 칭합니다.
    - 하드 디스크의 가장 작은 전송 단위입니다.
    - 일반적으로 512바이트 크기를 가지지만 정확한 크기는 하드 디스크에 따라 다릅니다.
- 실린더란?
    - 여러 겹의 플래터 상에서 같은 트랙이 위치한 곳을 모아 연결한 논리적 단위

연속된 정보는 한 실린더에 기록됩니다.

예를 들어 두 개의 플래터를 사용하는 하드 디스크에서 네 개 섹터에 걸쳐 데이터를 저장할 때는

첫 번째 플래터 윗면, 뒷면과 두 번째 플래터 윗면, 뒷면에 데이터를 저장합니다.

⇒ 연속된 정보를 하나의 실린더에 기록하는 이유는 디스크 암을 움직이지 않고 바로 데이터에 접근할 수 있기 때문입니다.

### 저장된 데이터에 접근하는 과정

하드 디스크가 저장된 데이터에 접근하는 시간은 크게 **탐색 시간, 회전 지연, 전송 시간**으로 나뉩니다.

- 탐색 시간
    - 접근 하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간을 의미합니다.
- 회전 지연
    - 헤드가 있는 곳으로 플래터를 회전 시키는 시간을 의미합니다.
- 전송 시간
    - 하드 디스크와 컴퓨터 간에 데이터를 전송하는 시간을 의미합니다.

위 시간들을 성능에 큰 영향을 끼치는 시간입니다.

탐색 시간과 회전 지연을 단축시키기 위해서는 RPM을 높이는 것도 중요하지만,

참조 지역성을 생각하는 것도 중요합니다.

### 다중 헤드 디스크와 고정 헤드 디스크

- 단일 헤드 디스크(이동 헤드 디스크)
    - 플래터의 한 면당 헤드가 하나씩 달려 있는 하드 디스크
- 다중 헤드 디스크(고정 헤드 디스크)
    - 헤드가 트랙별로 여러 개 달려 있는 하드 디스크

### 플래시 메모리

플래시 메모리는 전기적으로 데이터를 읽고 쓸 수 있는 반도체 기반의 저장 장치입니다.

플래시 메모리는 보조 기억 장치 범주에만 속한다기보다는 

다양한 곳에서 널리 사용하는 저장 장치로 보는 것이 옳습니다.

<aside>

> 두 종류의 플래시 메모리
> - NAND 플래시 메모리 <br>
    - NAND 게이트 기반 <br>
    - 대용량 저장 장치로 많이 사용된다. <br>
> - NOR 플래시 메모리 <br>
    - NOR 게이트 기반
   


</aside>

### 셀이란?

플래시 메모리에는 **셀**이라는 단위가 있습니다.

셀이란 플래시 메모리에서 데이터를 저장하는 가장 작은 단위입니다.

하나의 셀에 몇 비트를 저장할 수 있느냐에 따라 플래시 메모리 종류가 나뉩니다.

한 셀에 1비트를 저장할 수 있는 플래시 메모리를 SLC 타입,

한 셀에 2비트를 저장할 수 있는 플래시 메모리를 MLC 타입,

한 셀에 3비트를 저장할 수 있는 플래시 메모리를 TLC 타입,

한 셀에 4비트를 저장할 수 있는 플래시 메모리를 QLC 타입이라고 합니다.

### SLC,MLC,TLC 타입의 특징과 차이점

### SLC 타입

한 셀로 두 개의 정보를 표현할 수 있습니다.

MLC, TLC 타입에 비해 비트의 빠른 입출력이 가능합니다.

수명도 MLC, TLC 타입보다 깁니다.

하지만 용량 대비 가격이 높습니다.

### MLC 타입

한 셀로 네 개의 정보를 표현할 수 있습니다.

SLC 타입보단 일반적으로 속도와 수명은 떨어지지만, 대용화하기 유리합니다.

### TLC 타입

한 셀당 여덟 개의 정보를 표현할 수 있어 대용량화 하기가 유리합니다.

일반적으로 SLC, MLC 타입보다 수명과 속도가 떨어지지만 용량 대비 가격이 저렴합니다.

⇒  데이터를 읽고 쓸 때가 많고 고성능을 원한다면 SLC타입

저가의 대용량 저장 장치를 원한다면 TLC타입

그 중간을 원한다면 MLC 타입

| 구분 | SLC | MLC | TLC |
| --- | --- | --- | --- |
| 셀당 bit | 1bit | 2bit | 3bit |
| 수명 | 길다 | 보통 | 짧다 |
| 읽기/쓰기 속도 | 빠르다 | 보통 | 느리다 |
| 용량 대비 가격 | 높다 | 보통 | 낮다 |

### 셀보다 더 큰 단위들

셀들이 모여 만들어진 단위를 **페이지,**

페이지가 모여 만들어진 단위를 **블록,**

블록이 모여 만들어진 단위를 **플레인,**

플레인이 모여 만들어진 단위를 **다이**라고 합니다.

플래시 메모리에서 읽기와 쓰기는 페이지 단위로 이루어집니다.

하지만 삭제는 페이지보다 큰 블록 단위로 이루어집니다.

읽기/쓰기 단위와 삭제 단위가 다르다는 것이 플래시 메모리의 가장 큰 특징 중 하나입니다.

### 페이지의 상태

- Free
    - 어떠한 데이터도 저장하고 있지 않아 새로운 데이터를 저장할 수 있는 상태
- Valid
    - 유효한 데이터를 저장하고 있는 상태
- Invalid
    - 유효하지 않은 데이터를 저장하고 있는 상태

플래시 메모리는 하드 디스크와 달리 덮어쓰기가 불가능하여,

Valid 상태인 페이지에는 새 데이터를 저장할 수 없습니다.

### 플래시 메모리의 간단한 동작 예시

X라는 블록이 네 개의 페이지로 이루어져 있습니다.

두 개의 페이지에는 A와 B라는 데이터가 저장되어 있습니다.

기존에 저장되어 있던 B는 그대로 둔 채 기존의 A만을 A’로 수정하고 싶다면,

플래시 메모리에서는 덮어쓰기가 불가능하기 때문에 기존에 저장된 A는 Invalid 상태가 되고

새로운 데이터 A’가 저장됩니다.

A와 같이 Invalid 값을 저장하고 있는 공간은 사용하지 않을 공간인데도 불구하고 용량을 차지하고 있습니다.

하지만 A만을 지울 수 없습니다. 플래시 메모리 삭제는 블록 단위로 수행되기 때문입니다.

그래서 최근 SSD를 비롯한 플래시 메모리는,

이런 Invalid 값을 정리하기 위해 가비지 컬렉션 기능을 제공합니다.

가비지 컬렉션은 유효한 페이지들만을 새로운 블록으로 복사한 뒤,

기존의 블록을 삭제하는 기능입니다.
