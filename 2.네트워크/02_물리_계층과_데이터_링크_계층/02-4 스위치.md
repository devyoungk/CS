## 스위치

데이터 링크의 네트워크 장비, 2계층에서 사용한다 하여 `L2 스위치` 라고도함

여러 포트에 호스트를 연결할 수 있는 점은 허브와 유사하지만

- 특정 MAC주소에만 신호를 보낼수 있다.
- 전이중 모드의 통신을 지원한다.

는 점에서 차이가 있다.

이러한 차이로 CSMA/CD프로토콜이 필요없어 대기 시간이 없고 성능상 이점이있다. 

### 스위치의 특징

**`MAC 주소 학습`**

특정 포트와 해당 포트에 연결된 호스트의 MAC주소와의 관계를 기억해 원하는 호스트에만 프레임을 전달 가능

스위치는 MAC 주소 학습을 위해 포트와 연결된 호스트의 MAC 주소 간의 연관 관계를 메모리에 표 형태(**`MAC 주소 테이블` )**로 기억함.

<img width="1040" height="286" alt="image" src="https://github.com/user-attachments/assets/886d1baa-9983-4b44-b517-06f93c13ff61" />

## MAC 주소 학습

<img width="940" height="466" alt="image" src="https://github.com/user-attachments/assets/d6facb1b-40a8-4cb0-af49-79a526ee7063" />

호스트 A가 호스트 C로 프레임을 전송한다고 가정해보자

<img width="967" height="517" alt="image" src="https://github.com/user-attachments/assets/1e9f731f-f082-4f99-a46a-a7b5c0df6cf0" />

처음에는 스위치가 호스트 MAC주소 - 포트 사이의 연관관계를 알지 못한다.

<img width="972" height="507" alt="image" src="https://github.com/user-attachments/assets/2f47d2d7-6d47-40f5-b91f-f2a1a06c1782" />

스위치가 호스트 A로 부터 처음 프레임을 수신하면 호스트 A의 MAC주소와 연결된 포트를 주소 테이블에 저장한다.

 

<img width="980" height="508" alt="image" src="https://github.com/user-attachments/assets/7daff631-42d0-4f6a-8e35-a00ddf7c4fb6" />

스위치는 아직 호스트 C의 포트번호를 모르기 때문에 송신지 포트(1번) 을 제외한 모든 포트로 프레임을 전송하는데 이를 **`플러딩`** 이라고 함

<img width="965" height="489" alt="image" src="https://github.com/user-attachments/assets/c370258d-089f-4435-bf6f-ab04d9a6e72d" />

B,D는 관련없는 프레임 받은거니까 폐기하고

호스트 C는 스위치로 응답 프레임을 전송, 이를 통해 스위치는 호스트 C의 포트도 알아내서 테이블에 기록함

<img width="965" height="520" alt="image" src="https://github.com/user-attachments/assets/1ddabf23-2b13-4ccc-bb56-6e808e343df6" />

이후 호스트 A가 C에게 프레임을 전송하면 B,D로 연결된 포트는 **`필터링`** 하고 호스트 C로 연결된 포트로만 프레임을 **`포워딩`** 

만약 주소 테이블에 등록된 포트에서 일정 시간동안 프레임을 전송 받지 못했다면 해당 항목은 삭제되는데 이함

## VLAN

Virtual LAN, 한대의 스위치로 가상의 LAN을 만드는 방법

허브 - 송신지 제외 모든 포트로 신호보냄 → 불필요한 트래픽 증가 → 성능저하

스위치 - 스위치에 연결된 호스트 중에서도 서로 메시지 주고받을일이 없거나 브로드캐스트 메시지 를 받을 필요가 없으면 같은 네트워크에 속할 필요가 없다 → 그럼 분리하면 되겠네? → 이때 구성하는게 **`VLAN`**

<img width="965" height="732" alt="image" src="https://github.com/user-attachments/assets/2c340e10-1e0f-4c1a-ae97-e49bcddc417e" />

### 포트 기반 VLAN

사전에  특정 포트에 VLAN을 할당하고, 해당 포트에 호스트를 연결 해서 VLAN에 포함시키는 방식

<img width="942" height="261" alt="image" src="https://github.com/user-attachments/assets/53320a84-d456-4fe2-a042-2196fddaaf08" />

한대의 스위치로만 포트 기반 VLAN을 나누면 포트수가 부족할 수 있다.

<img width="946" height="509" alt="image" src="https://github.com/user-attachments/assets/8ce36b3c-2e13-4960-ae98-765c31306c50" />

여러대로 VLAN을 확장할 수도 있지만 낭비되는 포트가 있다. (각 VLAN마다 한 포트씩은 서 연결해야함)

이때 사용하는 방법이 **`VLAN 트렁킹`** 이다.

<img width="981" height="566" alt="image" src="https://github.com/user-attachments/assets/189fc878-acfe-435a-9bbb-5c4bb26ab813" />

그림과 같이 트렁크 포트를 사용하면 스위치 두개를 서로 연결 가능

### MAC 기반 VLAN

사전 설정된 MAC 주소에 따라 VLAN이 결정되는 방식
