# 💻 네트워크 심층 분석 스터디 자료

## 1. 프로토콜 (Protocol)

**프로토콜**이란 간단히 말해 컴퓨터 네트워크에서 장치 간에 데이터를 원활하게 교환하기 위한 "약속" 또는 "규칙"입니다. 우리가 한국어로 대화하듯, 컴퓨터도 서로 알아들을 수 있는 공통된 언어가 필요한데, 이것이 바로 프로토콜입니다.

-   **주요 기능**: 데이터의 형식, 순서, 에러 처리, 흐름 제어 등을 정의합니다.
-   **예시**:
    -   **HTTP (HyperText Transfer Protocol)**: 웹 브라우저와 웹 서버 간에 HTML 문서나 이미지 등을 주고받기 위한 약속입니다.
    -   **TCP (Transmission Control Protocol)**: 데이터가 정확하고 순서대로 전달되도록 보장하는 약속입니다.
    -   **IP (Internet Protocol)**: 데이터를 목적지까지 찾아갈 수 있도록 주소를 부여하고 경로를 설정하는 약속입니다.

> #### **백엔드 개발자를 위한 인사이트**
>
> 백엔드 개발자는 수많은 프로토콜 위에서 동작하는 애플리케이션을 만듭니다. 특히 **HTTP**는 웹 API를 설계하고 구현하는 데 있어 가장 기본이 되는 프로토콜입니다. **HTTP 메서드(GET, POST, PUT, DELETE 등), 상태 코드(200, 404, 500 등), 헤더**의 의미를 정확히 이해하는 것은 안정적이고 확장성 있는 API를 만드는 첫걸음입니다. 또한, 실시간 통신을 위해 **WebSocket** 프로토콜을 사용하거나, 데이터베이스 연결을 위한 특정 프로토콜(예: MySQL Protocol)을 이해하는 것도 중요합니다. **프로토콜의 동작 방식을 이해하면 문제 발생 시 원인을 더 빠르고 정확하게 파악할 수 있습니다.**

---

## 2. 네트워크 참조 모델 (Network Reference Model)

복잡한 네트워크 통신 과정을 역할별로 나누어 쉽게 이해하고 관리할 수 있도록 만든 "청사진" 또는 "지도"와 같습니다. 각 계층(Layer)은 특정 역할을 수행하며, 바로 위아래 계층과만 상호작용합니다.

### OSI 7계층 모델 (OSI 7 Layer Model)

-   국제표준화기구(ISO)에서 만든 이론적인 모델로, 네트워크 통신 과정을 7개의 계층으로 나눕니다. 실제 인터넷은 TCP/IP 모델을 기반으로 하지만, **OSI 모델은 네트워크의 전체 흐름을 이해하고 문제 해결의 범위를 특정하는 데 매우 유용한 개념적 프레임워크**입니다.

    -   **7계층 (응용 계층 - Application)**: 사용자와 직접 상호작용하는 계층. (HTTP, FTP, DNS)
    -   **6계층 (표현 계층 - Presentation)**: 데이터의 형식(인코딩, 암호화)을 결정.
    -   **5계층 (세션 계층 - Session)**: 통신의 시작과 끝, 동기화를 관리.
    -   **4계층 (전송 계층 - Transport)**: 데이터의 신뢰성 있는 전송을 보장. (TCP, UDP)
    -   **3계층 (네트워크 계층 - Network)**: 데이터의 경로를 설정(라우팅). (IP)
    -   **2계층 (데이터 링크 계층 - Data Link)**: 물리적으로 연결된 두 장치 간의 신뢰성 있는 전송을 담당. (이더넷)
    -   **1계층 (물리 계층 - Physical)**: 데이터를 전기 신호로 변환하여 전송. (케이블, 허브)

### TCP/IP 4계층 모델 (TCP/IP 4 Layer Model)

-   현재 인터넷에서 실제로 사용되는 모델로, OSI 모델을 더 실용적으로 단순화한 것입니다.

    -   **4계층 (애플리케이션 계층 - Application)**: OSI 5, 6, 7계층에 해당. (HTTP, FTP, DNS)
    -   **3계층 (전송 계층 - Transport)**: OSI 4계층에 해당. (TCP, UDP)
    -   **2계층 (인터넷 계층 - Internet)**: OSI 3계층에 해당. (IP)
    -   **1계층 (네트워크 인터페이스 계층 - Network Interface)**: OSI 1, 2계층에 해당. (이더넷)

> #### **백엔드 개발자를 위한 인사이트**
>
> 우리는 주로 '애플리케이션 계층(HTTP)'과 '전송 계층(TCP/UDP)'에서 작업합니다. 하지만 네트워크 관련 장애가 발생했을 때(예: "서버에 연결할 수 없습니다"), 이 모델을 통해 문제의 원인이 어디에 있는지 체계적으로 추론할 수 있습니다.
>
> -   **애플리케이션 로그**에 에러가 없다면? -> 전송 계층(TCP)의 포트 문제나 방화벽 이슈일 수 있습니다.
> -   서버 자체에 `ping` (네트워크 계층 - IP)이 도달하지 않는다면? -> 네트워크 장비(라우터)나 서버의 네트워크 설정 문제일 수 있습니다.
>
> 이처럼 **계층별로 사고하는 능력**은 트러블슈팅의 효율을 극적으로 높여줍니다.

---

## 3. 캡슐화와 역캡슐화 (Encapsulation & Decapsulation)

데이터가 각 계층을 통과하면서 필요한 정보(헤더)가 추가되거나 제거되는 과정입니다.

-   **캡슐화 (Encapsulation)**
    -   **데이터를 보내는 쪽**에서 일어나는 과정입니다.
    -   애플리케이션 계층에서부터 아래 계층으로 데이터가 내려가면서, 각 계층은 자신의 역할에 필요한 **"헤더(Header)"** 정보를 데이터 앞에 붙입니다. 마치 택배를 보낼 때 상자에 물건을 담고, 송장을 붙이는 것과 같습니다.

-   **역캡슐화 (Decapsulation)**
    -   **데이터를 받는 쪽**에서 일어나는 과정입니다.
    -   물리 계층부터 위 계층으로 데이터가 올라가면서, 각 계층은 자신이 추가했던 헤더를 해석하고 제거한 후, 상위 계층으로 데이터를 전달합니다. 택배를 받은 후 송장을 떼고 상자를 여는 것과 같습니다.

---

## 4. PDU (Protocol Data Unit)

각 계층에서 캡슐화를 통해 만들어진 데이터 단위를 **PDU**라고 부릅니다. 각 계층마다 부르는 이름이 다릅니다.

-   **애플리케이션 계층**: 메시지 (Message) 또는 데이터 (Data)
-   **전송 계층 (TCP)**: **세그먼트 (Segment)**
-   **전송 계층 (UDP)**: **데이터그램 (Datagram)**
-   **네트워크 계층**: **패킷 (Packet)**
-   **데이터 링크 계층**: **프레임 (Frame)**
-   **물리 계층**: 비트 (Bit)

> #### **백엔드 개발자를 위한 인사이트**
>
> **패킷 캡처** 도구(예: **Wireshark**)를 사용하면 실제 네트워크를 오가는 PDU의 구조를 눈으로 직접 확인할 수 있습니다. 예를 들어, API 요청이 느릴 때 Wireshark로 패킷을 분석하면, TCP 레벨에서 재전송(Retransmission)이 많이 발생하는지, 아니면 특정 HTTP 헤더 때문에 문제가 생기는지 등 **로우 레벨(low-level)의 원인 분석**이 가능해집니다. 이는 단순한 코드 디버깅만으로는 알 수 없는 깊이 있는 인사이트를 제공합니다.

---

## 5. OSI 7계층, TCP/IP 4계층은 사실 아무것도 해주지 않는다

이 모델들은 '개념적인 프레임워크'일 뿐, 실제로 데이터를 처리하는 주체가 아닙니다. 실제 일은 각 계층의 역할을 수행하는 '프로토콜'과 그 프로토콜을 구현한 '소프트웨어/하드웨어'가 담당합니다.

-   **OSI 모델의 역할**: "4계층에서는 신뢰성 있는 통신을 책임져야 해!" 라고 **역할을 정의**합니다.
-   **프로토콜의 역할 (TCP)**: 그 역할을 수행하기 위해 **3-way-handshake, 흐름 제어, 혼잡 제어**와 같은 구체적인 **방법을 구현**합니다.

즉, 모델은 설계도이고, 프로토콜은 그 설계도를 따라 만든 실제 기능이라고 생각하면 쉽습니다.

---

## 6. [좀 더 알아보기] 트래픽과 네트워크 성능 지표

백엔드 개발자는 서비스의 성능을 모니터링하고 최적화해야 할 의무가 있습니다. 이때 중요한 네트워크 성능 지표는 다음과 같습니다.

-   **처리율 (Throughput)**
    -   **실제로** 단위 시간당 성공적으로 전송된 데이터의 양을 의미합니다. (단위: bps - bits per second)
    -   "우리 서비스는 초당 100MB의 데이터를 실제로 처리하고 있어." 와 같이 표현합니다.

-   **대역폭 (Bandwidth)**
    -   네트워크가 전송할 수 있는 **이론적인 최대** 데이터 전송량을 의미합니다.
    -   고속도로의 '최대 제한 속도'나 '차선 수'에 비유할 수 있습니다.
    -   "우리 서버는 1Gbps 대역폭의 네트워크에 연결되어 있어."

-   **패킷 손실 (Packet Loss)**
    -   네트워크를 통해 전송된 패킷 중 일부가 목적지에 도달하지 못하고 중간에 사라지는 현상입니다.
    -   패킷 손실이 발생하면, TCP는 해당 패킷을 재전송해야 하므로 **성능 저하의 직접적인 원인**이 됩니다.

> #### **백엔드 개발자를 위한 인사이트**
>
> **대역폭이 넓다고 해서 항상 처리율이 높은 것은 아닙니다.** 고속도로가 10차선이라도 차가 막히면(네트워크 혼잡, 패킷 손실) 실제 통행량(처리율)은 떨어지는 것과 같습니다. 백엔드 개발자는 다음과 같은 점을 고려해야 합니다.
>
> -   **API 응답 크기 최적화**: 불필요한 데이터를 줄이고, 데이터를 압축(Gzip 등)하여 전송하면 **처리율을 높이고 대역폭 사용량을 줄일 수 있습니다.**
> -   **CDN(Content Delivery Network) 활용**: 이미지나 동영상 같은 큰 정적 파일을 사용자에게 가까운 CDN 서버에서 전송하게 하면, 우리 서버의 **대역폭 부담을 줄이고 사용자는 더 빠른 속도를 경험**할 수 있습니다.
> -   **모니터링**: APM(Application Performance Monitoring) 툴을 통해 **응답 시간(Latency), 처리율, 패킷 손실률** 등을 지속적으로 모니터링하여 병목 지점을 찾아내고 개선해야 합니다.
